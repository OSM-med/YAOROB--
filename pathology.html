<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Рекомендации</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root{
      --border:#8fbce6;
      --soft:#f4f9ff;
      --soft2:#e9f3ff;
      --text:#111;
      --shadow:0 8px 20px rgba(0,0,0,0.06);
    }

    body{
      margin:0;
      padding:16px;
      font-family:Arial, sans-serif;
      background:#fff;
      color:var(--text);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }
    .container{ max-width:980px; margin:0 auto; }

    .back-link{
      display:inline-block;
      margin-bottom:18px;
      text-decoration:none;
      color:var(--text);
      font-weight:700;
    }

    h1{
      text-align:center;
      font-size:24px;
      font-weight:900;
      margin:6px 0 18px 0;
      letter-spacing:0.2px;
    }

    .question-box{
      background-color:var(--soft);
      border:2px solid var(--border);
      border-radius:18px;
      padding:22px 18px;
      margin-bottom:22px;
    }

    .question-box-title{
      text-align:center;
      font-size:18px;
      font-weight:900;
      margin-bottom:14px;
      letter-spacing:0.2px;
      line-height:1.25;
    }

    .questions{
      display:grid;
      grid-template-columns:1fr;
      gap:12px;
    }

    .question{
      background:#ffffff;
      border:2px solid var(--border);
      border-radius:14px;
      padding:14px 12px;
      font-size:16px;
      font-weight:900;
      text-align:center;
      cursor:pointer;
      transition:0.2s ease;
      user-select:none;
      line-height:1.25;
    }
    .question:hover{
      background:var(--soft2);
      transform:translateY(-1px);
    }
    .question.active{
      background:#111;
      color:#fff;
      border-color:#111;
      transform:none;
    }

    .content{
      background:#fff;
      border-radius:16px;
      padding:20px;
      box-shadow:var(--shadow);
    }

    .content h2{
      font-size:18px;
      font-weight:900;
      margin:0 0 10px 0;
      letter-spacing:0.2px;
      line-height:1.25;
    }

    .content p,
    .content li{
      font-size:16px;
      line-height:1.65;
      margin:8px 0;
    }
    .content ul{ padding-left:18px; margin:8px 0 0 0; }

    /* ===== Выбор операции: теперь как все остальные рамки (НЕ синий фон) ===== */
    .op-wrap{
      display:flex;
      justify-content:center;
      margin:14px 0 0 0;
    }
    .op-box{
      width:100%;
      max-width:720px;
      background:var(--soft);
      border:2px solid var(--border);
      border-radius:18px;
      padding:18px 16px;
    }
    .op-title{
      text-align:center;
      font-size:18px;
      font-weight:900;
      margin:0 0 12px 0;
      letter-spacing:0.2px;
      line-height:1.25;
      color:var(--text);
    }
    .op-grid{
      display:grid;
      grid-template-columns:1fr;
      gap:10px;
    }

    /* Кнопки операций — как обычные разделы */
    .op-btn{
      background:#fff;
      color:var(--text);
      border:2px solid var(--border);
      border-radius:14px;
      padding:14px 12px;
      font-size:16px;
      font-weight:900;
      cursor:pointer;
      transition:0.2s ease;
      line-height:1.25;
    }
    .op-btn:hover{
      background:var(--soft2);
      transform:translateY(-1px);
    }
    .op-btn.active{
      background:#111;
      color:#fff;
      border-color:#111;
      transform:none;
    }

    .postop-wrap{ margin-top:18px; }

    @media (max-width:480px){
      body{ padding:12px; }
      h1{ font-size:22px; }
      .content{ padding:18px; }
      .question{ font-size:16px; }
      .op-btn{ font-size:16px; }
    }
  </style>
</head>

<body>
  <div class="container">

    <a href="recommendations.html" class="back-link">← Вернуться к выбору заболевания</a>
    <h1 id="pathologyTitle">Рекомендации</h1>

    <div class="question-box">
      <div class="question-box-title">Выберите, какая информация вам сейчас нужна</div>

      <div class="questions" id="mainQuestions">
        <div class="question" data-key="about">Ознакомиться с данной патологией</div>

        <div class="question" data-key="chemo">Исследования перед госпитализацией на химиотерапию</div>
        <div class="question" data-key="post_chemo">Рекомендации после курса химиотерапии</div>

        <div class="question" data-key="surgery">Исследования перед госпитализацией для хирургического лечения</div>
        <div class="question" data-key="post_surgery">Рекомендации после хирургического лечения</div>

        <div class="question" data-key="rt">Исследования перед госпитализацией для лучевой терапии</div>
        <div class="question" data-key="post_rt">Рекомендации после лучевого лечения</div>

        <div class="question" data-key="followup">
          Наблюдение после завершения лечения.
          Какие обследования нужно проходить и с какой периодичностью
        </div>
      </div>
    </div>

    <div class="content" id="content">
      <h2>Выберите пункт выше</h2>
      <p>После выбора раздела здесь появятся рекомендации.</p>
    </div>

  </div>

  <script>
    const DATA = {
      gastric: {
        title: "Рак желудка",

        about: `
          <h2>О заболевании</h2>
          <p>Рак желудка — злокачественное заболевание, лечение которого может включать хирургическое вмешательство, химиотерапию и лучевую терапию.</p>
        `,

        chemo: `
          <h2>Перед госпитализацией на химиотерапию</h2>
          <p>Раздел будет заполнен.</p>
        `,

        post_chemo: `
          <h2>Рекомендации после курса химиотерапии</h2>
          <ul>
            <li>при температуре ≥38°C — срочно обратиться к врачу</li>
            <li>контроль самочувствия и побочных эффектов</li>
            <li>дробное питание, достаточный питьевой режим</li>
          </ul>
        `,

        surgery: `
          <h2>Перед госпитализацией для хирургического лечения</h2>
          <p>Раздел будет заполнен.</p>
        `,

        rt: `
          <h2>Перед госпитализацией для лучевой терапии</h2>
          <p>Раздел будет заполнен.</p>
        `,

        post_rt: `
          <h2>Рекомендации после лучевого лечения</h2>
          <ul>
            <li>уход за кожей в зоне облучения</li>
            <li>избегать солнечного воздействия</li>
            <li>сообщать врачу о боли, слабости, нарушении глотания</li>
          </ul>
        `,

        followup: `
          <h2>Наблюдение после завершения лечения</h2>
          <ul>
            <li><strong>1–2 годы:</strong> осмотр каждые 3–6 месяцев</li>
            <li><strong>3–5 годы:</strong> каждые 6–12 месяцев</li>
            <li><strong>после 5 лет:</strong> ежегодно</li>
          </ul>
        `
      }
    };

    const DIET_PAGES = { distal: "diet-distal.html" };
    const ACTIVITY_PAGE = "activity-gastric-postop.html";

    const params = new URLSearchParams(window.location.search);
    const key = params.get("p") || "gastric";

    const titleEl = document.getElementById("pathologyTitle");
    const contentEl = document.getElementById("content");
    const questions = document.querySelectorAll("#mainQuestions .question");

    function centerElement(el){
      if (!el) return;
      el.scrollIntoView({ behavior:"smooth", block:"center" });
    }

    function currentReturnUrl(){
      const file = window.location.pathname.split("/").pop() || "pathology.html";
      return file + window.location.search;
    }

    function openActivity(){
      window.location.href = ACTIVITY_PAGE + "?return=" + encodeURIComponent(currentReturnUrl());
    }

    function renderOperationSelector(){
      contentEl.innerHTML = `
        <h2>Рекомендации после хирургического лечения</h2>

        <div class="op-wrap" id="opWrap">
          <div class="op-box">
            <div class="op-title">Выберите, какая операция выполнена</div>

            <div class="op-grid">
              <button class="op-btn" data-op="distal">Субтотальная дистальная резекция желудка</button>
              <button class="op-btn" data-op="proximal">Проксимальная резекция желудка</button>
              <button class="op-btn" data-op="gastrectomy">Гастрэктомия</button>
            </div>
          </div>
        </div>

        <div class="postop-wrap" id="postOpWrap"></div>
      `;

      centerElement(document.getElementById("opWrap"));

      const btns = contentEl.querySelectorAll(".op-btn");
      btns.forEach(b=>{
        b.addEventListener("click", ()=>{
          btns.forEach(x=>x.classList.remove("active"));
          b.classList.add("active");
          renderPostOpSections(b.dataset.op);
        });
      });
    }

    function renderPostOpSections(opKey){
      const wrap = document.getElementById("postOpWrap");
      if (!wrap) return;

      const opLabel = {
        distal:"Субтотальная дистальная резекция желудка",
        proximal:"Проксимальная резекция желудка",
        gastrectomy:"Гастрэктомия"
      }[opKey] || "Операция";

      wrap.innerHTML = `
        <div class="question-box" id="postOpBox">
          <div class="question-box-title">${opLabel}: выберите раздел рекомендаций</div>
          <div class="questions">
            <div class="question post-op" data-post="activity">Рекомендации по физической активности</div>
            <div class="question post-op" data-post="nutrition">Рекомендации по питанию</div>
            <div class="question post-op" data-post="meds">Рекомендации по приёму лекарственных препаратов</div>
            <div class="question post-op" data-post="followup">Рекомендации по наблюдению после операции</div>
          </div>
        </div>

        <div class="content" id="postOpContent">
          <p>Выберите раздел выше.</p>
        </div>
      `;

      centerElement(document.getElementById("postOpBox"));

      // Делегирование + один обработчик на выбранную операцию (чтобы не копить)
      wrap.addEventListener("click", (e)=>{
        const btn = e.target.closest(".post-op");
        if (!btn) return;

        const sec = btn.dataset.post;

        wrap.querySelectorAll(".post-op").forEach(x=>x.classList.remove("active"));
        btn.classList.add("active");

        // Физическая активность -> всегда отдельный файл
        if (sec === "activity"){
          openActivity();
          return;
        }

        // питание для distal — отдельной страницей
        if (sec === "nutrition" && opKey === "distal"){
          window.location.href = DIET_PAGES.distal + "?from=pathology&p=" + encodeURIComponent(key);
          return;
        }

        const postContent = document.getElementById("postOpContent");
        if (!postContent) return;
        postContent.innerHTML = "<p>Раздел будет добавлен позже.</p>";
        centerElement(postContent);

      }, { once:true });
    }

    if (!DATA[key]){
      titleEl.textContent = "Раздел в разработке";
      contentEl.innerHTML = "<p>Информация для данной патологии будет добавлена.</p>";
    } else {
      titleEl.textContent = DATA[key].title;

      questions.forEach(q=>{
        q.addEventListener("click", ()=>{
          questions.forEach(x=>x.classList.remove("active"));
          q.classList.add("active");

          const section = q.dataset.key;

          if (section === "post_surgery"){
            renderOperationSelector();
            return;
          }

          contentEl.innerHTML = DATA[key][section] || "<p>Раздел будет добавлен позже.</p>";
          centerElement(contentEl);
        });
      });
    }
  </script>
</body>
</html>
